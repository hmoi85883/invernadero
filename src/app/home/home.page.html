<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-title style="font-size: 22px; padding-left: 10px;">Dashboard</ion-title>
    
    <ion-buttons slot="end">
      
      <ion-button (click)="verNotificaciones()" style="position: relative; margin-right: 5px;">
        <ion-icon name="notifications" color="light" style="font-size: 24px;"></ion-icon>
        
        <div *ngIf="data.notificaciones.length > 0" 
             style="
               position: absolute; 
               top: 8px; 
               right: 8px; 
               background: var(--ion-color-danger); 
               border-radius: 50%; 
               width: 8px; 
               height: 8px;
               box-shadow: 0 0 5px red;
             ">
        </div>
      </ion-button>

      <ion-button routerLink="/perfil" style="background: #2c2c2c; border-radius: 50%; width: 40px; height: 40px; margin-right: 10px;">
        <ion-icon name="person" color="light"></ion-icon>
      </ion-button>
      
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div style="margin-bottom: 20px; padding-left: 5px;">
    <p style="margin: 0; color: #888;">Bienvenido de nuevo,</p>
    <h2 style="margin: 5px 0 0; font-size: 24px;">{{ data.usuario }}</h2>
  </div>

  <div *ngFor="let inv of data.invernaderos" (click)="irDetalle(inv.id)" class="premium-card ion-activatable ripple-parent">
    <ion-ripple-effect></ion-ripple-effect>
    
    <div style="padding: 20px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <div>
          <h3 style="margin: 0; font-size: 18px; color: white;">{{ inv.nombre }}</h3>
          <span style="font-size: 12px; color: #666; display: flex; align-items: center; margin-top: 4px;">
            <ion-icon name="location-outline" style="margin-right: 4px;"></ion-icon> {{ inv.ubicacion }}
          </span>
        </div>
        <div style="text-align: right;">
           <ion-badge [color]="inv.estado === 'ONLINE' ? 'primary' : 'danger'" style="padding: 6px 10px; border-radius: 6px;">{{ inv.estado }}</ion-badge>
        </div>
      </div>

      <div style="height: 1px; background: #333; margin-bottom: 15px;"></div>

      <div style="display: flex; gap: 15px;">
        <div *ngFor="let s of inv.sensores.slice(0, 2)" style="display: flex; align-items: center;">
          <ion-icon [name]="data.analizarSensor(s.nombre, s.valor).icono" [color]="data.analizarSensor(s.nombre, s.valor).color" style="font-size: 18px; margin-right: 8px;"></ion-icon>
          <span style="color: #ddd; font-weight: 500;">{{ s.valor }}</span>
        </div>
        <div *ngIf="inv.sensores.length > 2" style="color: #666; font-size: 12px; align-self: center;">
          +{{ inv.sensores.length - 2 }} m√°s
        </div>
      </div>
    </div>

    <div style="background: #252525; padding: 10px 20px; display: flex; justify-content: flex-end; border-top: 1px solid #333;">
       <ion-button fill="clear" color="medium" size="small" (click)="borrar($event, inv.id)">
         <ion-icon name="trash-outline" slot="icon-only" style="font-size: 18px;"></ion-icon>
       </ion-button>
    </div>
  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button 
      (click)="data.solicitarNuevo()" 
      color="primary" 
      style="
        --box-shadow: 0 0 15px rgba(0, 212, 98, 0.6); 
        --border-radius: 50%;
        margin-bottom: 10px; 
        margin-right: 10px;
      ">
      <ion-icon name="add" style="color: black; font-size: 28px;"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>